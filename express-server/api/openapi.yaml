openapi: 3.0.3
info:
  description: "API designed to manage users, rooms, events, bookings, and tags within\
    \ the Maia University Campus."
  title: Maia Campus Event Management API
  version: 1.0.0
servers:
- url: http://localhost:8080
  variables:
    basePath:
      default: /
paths:
  /users:
    get:
      operationId: getUsers
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/user"
                type: array
          description: List of registered users
        "500":
          description: Internal server error
      summary: Retrieve all users
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    post:
      operationId: createUser
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/user"
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/user"
          description: User successfully created
        "400":
          description: Invalid data or missing fields
        "409":
          description: A user with this email already exists
        "500":
          description: Internal server error
      summary: Create a new user
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /users/{id}:
    delete:
      operationId: deleteUser
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          description: User deleted
        "404":
          description: User not found
        "500":
          description: Internal server error
      summary: Delete a user
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    get:
      operationId: getUserById
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/user"
          description: User found
        "404":
          description: User not found
        "500":
          description: Internal server error
      summary: Retrieve a user by ID
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    put:
      operationId: updateUser
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/user"
        required: true
      responses:
        "200":
          description: User successfully updated
        "400":
          description: Invalid data
        "404":
          description: User not found
        "409":
          description: Email already in use
        "500":
          description: Internal server error
      summary: Update an existing user
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /rooms:
    get:
      operationId: getRooms
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/room"
                type: array
          description: List of campus rooms
        "500":
          description: Internal server error
      summary: Retrieve all rooms
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    post:
      operationId: createRoom
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/room"
        required: true
      responses:
        "201":
          description: Room successfully created
        "400":
          description: Invalid data
        "409":
          description: A room with this name already exists
        "500":
          description: Internal server error
      summary: Create a new room
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /rooms/{id}:
    delete:
      operationId: deleteRoom
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          description: Room deleted
        "404":
          description: Room not found
        "409":
          description: Room has associated events
        "500":
          description: Internal server error
      summary: Delete a room
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    get:
      operationId: getRoomById
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/room"
          description: Room found
        "404":
          description: Room not found
        "500":
          description: Internal server error
      summary: Retrieve a room by ID
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    put:
      operationId: updateRoom
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/room"
        required: true
      responses:
        "200":
          description: Room updated successfully
        "400":
          description: Invalid data
        "404":
          description: Room not found
        "409":
          description: Room name already exists
        "500":
          description: Internal server error
      summary: Update room information
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /tags:
    get:
      operationId: getTags
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/tag"
                type: array
          description: List of available tags
        "500":
          description: Internal server error
      summary: Retrieve all tags
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    post:
      operationId: createTag
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/tag"
        required: true
      responses:
        "201":
          description: Tag successfully created
        "400":
          description: Invalid data
        "409":
          description: A tag with this name already exists
        "500":
          description: Internal server error
      summary: Create a new tag
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /tags/{id}:
    delete:
      operationId: deleteTag
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          description: Tag deleted
        "404":
          description: Tag not found
        "409":
          description: Tag is associated with events
        "500":
          description: Internal server error
      summary: Delete a tag
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    get:
      operationId: getTagById
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/tag"
          description: Tag found
        "404":
          description: Tag not found
        "500":
          description: Internal server error
      summary: Retrieve a tag by ID
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    put:
      operationId: updateTag
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/tag"
        required: true
      responses:
        "200":
          description: Tag successfully updated
        "400":
          description: Invalid data
        "404":
          description: Tag not found
        "409":
          description: A tag with this name already exists
        "500":
          description: Internal server error
      summary: Update an existing tag
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /events:
    get:
      operationId: getEvents
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/event"
                type: array
            application/xml:
              schema:
                items:
                  $ref: "#/components/schemas/event"
                type: array
                xml:
                  name: Event
          description: List of registered events
        "500":
          description: Internal server error
      summary: Retrieve all events
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    post:
      operationId: createEvent
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/event"
          application/xml:
            schema:
              $ref: "#/components/schemas/event"
        required: true
      responses:
        "201":
          description: Event successfully created
        "400":
          description: "Invalid data (dates, room, or tag)"
        "404":
          description: Room or tag not found
        "409":
          description: The room is occupied during this time period
        "500":
          description: Internal server error
      summary: Create a new event
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /events/{id}:
    delete:
      operationId: deleteEvent
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          description: Event deleted
        "404":
          description: Event not found
        "409":
          description: The event has associated bookings
        "500":
          description: Internal server error
      summary: Delete an event
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    get:
      operationId: getEventById
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/event"
          description: Event found
        "404":
          description: Event not found
        "500":
          description: Internal server error
      summary: Retrieve an event by ID
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    put:
      operationId: updateEvent
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/event"
        required: true
      responses:
        "200":
          description: Event successfully updated
        "400":
          description: Invalid data
        "404":
          description: Event not found
        "409":
          description: The room is occupied during the updated time
        "500":
          description: Internal server error
      summary: Update an existing event
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /bookings:
    get:
      operationId: getBookings
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/booking"
                type: array
            application/xml:
              schema:
                items:
                  $ref: "#/components/schemas/booking"
                type: array
                xml:
                  name: Booking
          description: List of all user bookings
        "500":
          description: Internal server error
      summary: Retrieve all bookings
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    post:
      operationId: createBooking
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/booking"
          application/xml:
            schema:
              $ref: "#/components/schemas/booking"
        required: true
      responses:
        "201":
          description: Booking successfully created
        "400":
          description: Invalid data or missing fields
        "404":
          description: User or event not found
        "409":
          description: User already has a booking for this event
        "500":
          description: Internal server error
      summary: Create a new booking
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /bookings/{id}:
    delete:
      operationId: deleteBooking
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          description: Booking deleted
        "404":
          description: Booking not found
        "500":
          description: Internal server error
      summary: Delete a booking
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    get:
      operationId: getBookingById
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/booking"
          description: Booking found
        "404":
          description: Booking not found
        "500":
          description: Internal server error
      summary: Retrieve a booking by ID
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
    put:
      operationId: updateBooking
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/booking"
        required: true
      responses:
        "200":
          description: Booking successfully updated
        "400":
          description: Invalid data
        "404":
          description: Booking not found
        "409":
          description: User already has a booking for this event
        "500":
          description: Internal server error
      summary: Update an existing booking
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /rooms/{id}/events:
    get:
      description: Returns all events assigned to a specific room.
      operationId: getEventsByRoom
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/event"
                type: array
          description: List of events assigned to this room
        "404":
          description: Room not found
        "500":
          description: Internal server error
      summary: Retrieve all events scheduled in a particular room
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /tags/{id}/events:
    get:
      description: Returns all events categorized with the given tag.
      operationId: getEventsByTag
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/event"
                type: array
          description: List of events with this tag
        "404":
          description: Tag not found
        "500":
          description: Internal server error
      summary: Retrieve all events associated with a specific tag
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /rooms/occupied:
    get:
      operationId: getOccupiedRooms
      parameters:
      - explode: true
        in: query
        name: date
        required: true
        schema:
          format: date
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/room"
                type: array
          description: List of rooms occupied on the specified date
        "400":
          description: Missing or invalid date parameter
        "500":
          description: Internal server error
      summary: Retrieve rooms that are occupied on a specific date
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /events/{id}/users:
    get:
      description: Returns the list of users who have a booking for this event.
      operationId: getUsersByEvent
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/user"
                type: array
          description: List of users attending the event
        "404":
          description: Event not found
        "500":
          description: Internal server error
      summary: Retrieve all users registered for an event
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /rooms/available:
    get:
      description: Returns only rooms that have no scheduled events during the selected
        time range.
      operationId: getAvailableRooms
      parameters:
      - explode: true
        in: query
        name: from
        required: true
        schema:
          format: date-time
          type: string
        style: form
      - explode: true
        in: query
        name: to
        required: true
        schema:
          format: date-time
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/room"
                type: array
          description: List of available rooms
        "400":
          description: Missing or invalid parameters
        "500":
          description: Internal server error
      summary: Retrieve available rooms within a time interval
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /events/search:
    get:
      description: Returns events whose title or description match the search query.
      operationId: searchEvents
      parameters:
      - explode: true
        in: query
        name: query
        required: true
        schema:
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/event"
                type: array
          description: Matching events
        "400":
          description: Missing query parameter
        "500":
          description: Internal server error
      summary: Search events by keywords
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
  /events/by-date:
    get:
      description: Returns all events occurring on a specific date.
      operationId: getEventsByDate
      parameters:
      - explode: true
        in: query
        name: date
        required: true
        schema:
          format: date
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/event"
                type: array
          description: Events occurring on the specified date
        "400":
          description: Missing or invalid date parameter
        "500":
          description: Internal server error
      summary: Retrieve events filtered by date
      tags:
      - MaiaCampusEventController
      x-eov-operation-handler: controllers/MaiaCampusEventControllerController
components:
  schemas:
    user:
      additionalProperties: false
      description: Basic information about a registered user.
      example:
        name: Ana Silva
        email: ana.silva@umaia.pt
        password: "12345"
        role: student
      properties:
        id:
          format: int64
          type: integer
        name:
          type: string
        email:
          type: string
        password:
          type: string
        role:
          type: string
      required:
      - email
      - name
      - password
      - role
      type: object
    room:
      additionalProperties: false
      description: Detailed information about a campus room.
      example:
        name: A.204
        capacity: 60
        building: A
        description: Laboratory
      properties:
        id:
          type: integer
        name:
          type: string
        capacity:
          type: integer
        building:
          type: string
        description:
          type: string
      required:
      - building
      - capacity
      - name
      type: object
    tag:
      additionalProperties: false
      description: Tag used to categorize events.
      example:
        name: Programming
      properties:
        id:
          type: integer
        name:
          type: string
      required:
      - name
      type: object
    event:
      additionalProperties: false
      description: Complete information about an event scheduled on campus.
      example:
        title: Node.js Workshop
        description: Introduction to the basics of Node.js
        room_id: 2
        tag_id: 1
        start_datetime: 2025-11-20T09:00:00
        end_datetime: 2025-11-20T11:00:00
      properties:
        id:
          type: integer
        title:
          type: string
        description:
          type: string
        room_id:
          type: integer
        tag_id:
          type: integer
        start_datetime:
          format: date-time
          type: string
        end_datetime:
          format: date-time
          type: string
      required:
      - end_datetime
      - room_id
      - start_datetime
      - tag_id
      - title
      type: object
    booking:
      additionalProperties: false
      description: Relationship between a user and an event (booking made).
      example:
        user_id: 3
        event_id: 1
      properties:
        id:
          type: integer
        user_id:
          type: integer
        event_id:
          type: integer
        created_at:
          format: date-time
          type: string
      required:
      - event_id
      - user_id
      type: object
